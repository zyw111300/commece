# 量子堆栈Python岗位Django笔试题

## 题目：Django 批量订单处理与商品搜索系统

### 背景场景
您需要基于 Django 搭建一个小型电商模块，要求同时支持“批量订单处理”与“商品搜索”两大功能，并能在高并发场景下稳定运行。该系统可能被多个外部 API 或前端调用，需确保数据的正确性与一致性。

### 核心需求
1. **批量订单处理**
   - 一次提交中，可下单多个不同商品；要求逐一扣减库存，并记录订单明细。
   - 任一商品库存不足时，需返回对应的失败信息，不影响其他商品的下单。
   - 要防止超卖、重复扣减等问题，需设计适当的锁或并发控制机制（可使用悲观锁、乐观锁或分布式锁等）。

2. **商品搜索功能**
   - 提供简单的商品搜索接口，可按商品名称、关键词等进行查询。
   - 大部分查询场景下会是高频读操作，需要使用缓存（如 Redis）设计好批量数据库搜索。
   - 缓存需与数据库保持一致，当商品信息更新或售罄时，需更新或失效缓存。

3. **数据库与缓存**
   - 请自行设计核心数据表与缓存结构（如存放库存、价格、关键词索引等）；
   - 说明当库存或商品信息改变时，如何更新数据库与缓存？若缓存连接失败或不可用时，如何降级或回退？

4. **异常处理与可扩展性**
   - 业务异常：如库存不足、订单格式非法、搜索关键字为空等，要有清晰的捕获与返回。
   - 系统异常：如数据库或缓存宕机，需要记录日志并提供合理的恢复或补偿策略。
   - 要求分层设计（例如：models、views、services/业务逻辑层、cache管理等），保证后续扩容或二次开发时可顺利集成分库分表、消息队列异步处理、限流等高级功能。
